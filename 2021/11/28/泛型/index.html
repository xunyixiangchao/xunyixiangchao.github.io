<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>泛型 - Lis</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Lis"><meta name="msapplication-TileImage" content="/img/2018.jpg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Lis"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta description="问题 123456781、为什么我们需要泛型？2、泛型类、泛型接口和泛型方法3、如何限定类型变量？4、泛型使用中的约束和局限性5、泛型类型能继承吗？6、泛型中通配符类型7、虚拟机是如何实现泛型的？8、反射获取泛型的真实类型"><meta property="og:type" content="blog"><meta property="og:title" content="Lis"><meta property="og:url" content="https://xunyixiangchao.github.io/"><meta property="og:site_name" content="Lis"><meta property="og:description" content="问题 123456781、为什么我们需要泛型？2、泛型类、泛型接口和泛型方法3、如何限定类型变量？4、泛型使用中的约束和局限性5、泛型类型能继承吗？6、泛型中通配符类型7、虚拟机是如何实现泛型的？8、反射获取泛型的真实类型"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://xunyixiangchao.github.io/img/2018.jpg"><meta property="article:published_time" content="2021-11-28T14:45:54.000Z"><meta property="article:modified_time" content="2025-05-15T06:43:15.561Z"><meta property="article:author" content="Lis"><meta property="article:tag" content="Java"><meta property="article:tag" content="泛型"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/2018.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/11/28/%E6%B3%9B%E5%9E%8B/"},"headline":"Lis","image":["http://example.com/img/og_image.png"],"datePublished":"2021-11-28T14:45:54.000Z","dateModified":"2025-05-15T06:43:15.561Z","author":{"@type":"Person","name":"Lis"},"description":"问题 123456781、为什么我们需要泛型？2、泛型类、泛型接口和泛型方法3、如何限定类型变量？4、泛型使用中的约束和局限性5、泛型类型能继承吗？6、泛型中通配符类型7、虚拟机是如何实现泛型的？8、反射获取泛型的真实类型"}</script><link rel="canonical" href="http://example.com/2021/11/28/%E6%B3%9B%E5%9E%8B/"><link rel="icon" href="/img/2018.jpg"><meta name="referrer" content="no-referrer-when-downgrade"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/highlight.js/9.12.0/styles/atom-one-light.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.12.0/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css?family=Ubuntu:400,600|Source+Code+Pro|Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Microsoft YaHei:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&amp;amp;subset=latin,latin-ext|Inconsolata|Itim|Lobster.css"><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="/js/globalUtils.js"></script><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/pace/1.0.2/pace.min.js"></script><link rel="stylesheet" href="/live2d/waifu.css"><script type="text/javascript" async src="/live2d/autoload.js"></script><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/atom.xml" title="Lis" type="application/atom+xml">
</head><body class="is-3-column has-navbar-fixed-top"><nav class="navbar navbar-main is-fixed-top"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/2018.jpg" alt="Lis" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/media">影音</a><a class="navbar-item" href="/album">相册</a><a class="navbar-item" href="/friend">友链</a><a class="navbar-item" href="/self-talking">碎碎念</a><a class="navbar-item" href="/message">留言</a><a class="navbar-item" href="/about">关于</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Join Gitter" href="https://xunyixiangchao.github.io/"><i class="fab fa-gitter"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="GitHub" href="https://xunyixiangchao.github.io/"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a><a class="navbar-item" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a></div></div></div></nav><script type="text/javascript" src="/js/theme-setting.js"></script><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><!--!--><div class="card"><article class="card-content article" role="article"><div class="article-meta size-small is-uppercase level is-mobile"><div class="level-left"><i class="far fa-calendar-plus"> </i>2021-11-28  <a class="commentCountImg" href="/2021/11/28/%E6%B3%9B%E5%9E%8B/#comment-container"><span class="display-none-class">87c43109c986a268524d96c0594afbdf</span><i class="far fa-comment-dots"></i> <span class="commentCount" id="87c43109c986a268524d96c0594afbdf">99+</span>  </a><span class="level-item"><i class="far fa-clock"> </i>30 分钟  <i class="fas fa-pencil-alt"> </i>4.5 k</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>次访问</span></div></div><h1 class="title is-3 is-size-4-mobile">泛型</h1><div class="content"><blockquote>
<h2><span id="问题">问题</span></h2></blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1、为什么我们需要泛型？</span><br><span class="line">2、泛型类、泛型接口和泛型方法</span><br><span class="line">3、如何限定类型变量？</span><br><span class="line">4、泛型使用中的约束和局限性</span><br><span class="line">5、泛型类型能继承吗？</span><br><span class="line">6、泛型中通配符类型</span><br><span class="line">7、虚拟机是如何实现泛型的？</span><br><span class="line">8、反射获取泛型的真实类型</span><br></pre></td></tr></table></figure>
<a id="more"></a>

<h2><span id="1-为什么需要泛型">1、为什么需要泛型？</span></h2><ul>
<li>多种数据类型执行相同的代码（增加代码复用性）</li>
<li>在编译时进行更强的类型检查。</li>
<li>使用泛型不需要强制转换类型</li>
</ul>
<h2><span id="2-泛型类-泛型接口和泛型方法">2、泛型类、泛型接口和泛型方法</span></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">--泛型类</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Genericity</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">	--泛型方法</span><br><span class="line">	<span class="keyword">public</span> &lt;T&gt; <span class="function">T <span class="title">getInput</span><span class="params">(T input)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> input;</span><br><span class="line">    &#125;</span><br><span class="line">    --泛型方法<span class="number">2</span></span><br><span class="line">    <span class="keyword">public</span> &lt;E&gt; <span class="function">E <span class="title">getInput2</span><span class="params">(E input)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> input;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    	<span class="comment">//泛型类</span></span><br><span class="line">        Genericity&lt;String&gt; genericity=<span class="keyword">new</span> Genericity&lt;&gt;();</span><br><span class="line">        genericity.setData(<span class="string">&quot;泛型&quot;</span>);</span><br><span class="line">        Genericity&lt;Integer&gt; genericityInteger=<span class="keyword">new</span> Genericity&lt;&gt;();</span><br><span class="line">        genericityInteger.setData(<span class="number">1</span>);</span><br><span class="line">        <span class="comment">//泛型方法</span></span><br><span class="line">        Genericity genericityMethod=<span class="keyword">new</span> Genericity();</span><br><span class="line">        genericityMethod.getInput(<span class="string">&quot;11&quot;</span>);</span><br><span class="line">        genericityMethod.getInput(<span class="number">11</span>);</span><br><span class="line">        genericityMethod.getInput(<span class="number">1f</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">--泛型接口</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Genertor</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">next</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line">--实现<span class="number">1</span>、不传入具体类型，返回值为T</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorImpl</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Genertor</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">--实现<span class="number">2</span>、传入具体类型String，返回值为String</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorImpl2</span> <span class="keyword">implements</span> <span class="title">Genertor</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">next</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<ul>
<li>泛型类只影响它的普通方法</li>
<li>泛型类的T和泛型方法的T毫无关系，换成其他也一样，例如E，但是方法名不能一样，因为泛型在Java编译时是Object</li>
<li>泛型接口实现时，不传入具体类型传入T时，接口的方法返回的也是T。当传入具体类型时，接口的方法返回的也是具体的类型。</li>
<li>泛型方法只有方法前面有<t>的才是泛型方法</t></li>
</ul>
<h2><span id="3-如何限定类型变量">3、如何限定类型变量？</span></h2><ol>
<li>限定类型是写在类上的</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorClass</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        GenertorClass&lt;String&gt; genertorClass = <span class="keyword">new</span> GenertorClass&lt;&gt;();</span><br><span class="line">        GenertorClass&lt;Object&gt; genertorClass2 = <span class="keyword">new</span> GenertorClass&lt;&gt;();</span><br><span class="line">		<span class="comment">//传入String是正常的，传入Object时报错：</span></span><br><span class="line">        <span class="comment">//Type parameter &#x27;java.lang.Object&#x27; is not within its bound; should implement &#x27;java.lang.Comparable&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面代码传入String时是正常的，传入Object时报错：<code>Type parameter &#39;java.lang.Object&#39; is not within its bound; should implement &#39;java.lang.Comparable&#39;</code></p>
<p>因为String继承了 Comparable接口，而Object没有继承该接口</p>
<ol start="2">
<li>限定类型写在方法上</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorClass</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Comparable</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span>  &lt;T extends Comparable&gt; <span class="function">T <span class="title">min</span><span class="params">(T a, T b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (a.compareTo(b) &gt; <span class="number">0</span>) <span class="keyword">return</span> a;<span class="keyword">else</span> <span class="keyword">return</span> b;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        GenertorClass.min(<span class="string">&quot;1&quot;</span>,<span class="string">&quot;2&quot;</span>);</span><br><span class="line">        GenertorClass.min(<span class="string">&quot;1&quot;</span>,<span class="keyword">new</span> Object());<span class="comment">//报reason: no instance(s) of type variable(s) exist so that Object conforms to Comparable</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>GenertorClass.min(“1”,”2”);是正确的，因为String继承了Comparable接口，而Object没有继承该接口。</p>
<ol start="3">
<li>多个限定类型</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">--类<span class="number">1</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fruit</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">--类<span class="number">2</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Apple</span> <span class="keyword">extends</span> <span class="title">Fruit</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">--类<span class="number">3</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorClass</span>&lt;<span class="title">T</span> <span class="keyword">extends</span> <span class="title">Fruit</span> &amp; <span class="title">Serializable</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        GenertorClass&lt;Apple&gt; genertorClass = <span class="keyword">new</span> GenertorClass&lt;&gt;();</span><br><span class="line">        GenertorClass&lt;Fruit&gt; genertorClass2 = <span class="keyword">new</span> GenertorClass&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>GenertorClass<apple>是正常的，GenertorClass<fruit>报错：<code>Type parameter &#39;Fruit&#39; is not within its bound; should implement &#39;java.io.Serializable&#39;</code>。</fruit></apple></p>
<p>因为两个限定类型都要实现才行，而且类3中Fruit&amp;Serializable两个位置不能调换。</p>
<ul>
<li>T extends B <strong>B可以是类也可以是接口。</strong></li>
<li>泛型类和泛型方法都可以使用多个限定类型</li>
<li>B可以是多个对象：T extends Comparable&amp;Serializable。<strong>多个对象时，传入的对象必需要同时实现多个限定类型Comparable和Serializable</strong></li>
<li><strong>B为类和接口混合时，类只能有一个（java里单继承，多实现），并且必需放在最前面 ,否则会报错。</strong></li>
</ul>
<h2><span id="4-泛型使用中的约束和局限性">4、泛型使用中的约束和局限性</span></h2><ul>
<li><p>不能实例化类型变量。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">T data = <span class="keyword">new</span> T()<span class="comment">//不允许</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>静态域或者静态方法里不能引用类型变量。</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> T instance;<span class="comment">//不允许</span></span><br></pre></td></tr></table></figure>
<p>（因为在new对象时，才知道真实的类型，虚拟机运行时，先执行static对象、方法，再执行构造方法，所以静态中使用泛型，虚拟机是不知道泛型类型的）</p>
</li>
<li><p>静态方法本身是泛型方法是可行的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">priavte <span class="keyword">static</span> &lt;T&gt; <span class="function">T  <span class="title">getInstance</span><span class="params">()</span></span>&#123;&#125;<span class="comment">//允许</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>基本类型是不行的。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">int</span>&gt;,&lt;<span class="keyword">double</span>&gt;<span class="comment">//不允许</span></span><br></pre></td></tr></table></figure>

<p>int,double(不是对象)，只允许其包装类Integer，Double</p>
</li>
<li><p>不能使用instanceof关键字判断变量类型。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Test&lt;Double&gt; test=<span class="keyword">new</span> Test&lt;&gt;();</span><br><span class="line"><span class="keyword">if</span>(test <span class="keyword">instanceof</span> Test&lt;Double&gt;)&#123;&#125;<span class="comment">//不允许  编译时的类型擦除</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>泛型能定义数据，但不能创建数组（new 对象）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> T[] list;<span class="comment">//允许</span></span><br><span class="line"><span class="keyword">private</span> T[] list2=<span class="keyword">new</span> T[<span class="number">2</span>];<span class="comment">//不允许</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>泛型类获取的一定是类的原生类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Test&lt;Integer&gt; test1 = <span class="keyword">new</span> Test&lt;&gt;();</span><br><span class="line">Test&lt;String&gt; test2 = <span class="keyword">new</span> Test&lt;&gt;();</span><br><span class="line">System.out.println(test1.getClass()==test2.getClass());</span><br><span class="line">System.out.println(test1.getClass().getName());</span><br><span class="line">System.out.println(test2.getClass().getName());</span><br><span class="line">out:========================================</span><br><span class="line"><span class="keyword">true</span></span><br><span class="line">com.example.annotation.Test</span><br><span class="line">com.example.annotation.Test</span><br></pre></td></tr></table></figure>

<p>这里的原生类型是Test，和传的参数无关</p>
</li>
<li><p>泛型类不能继承Exception</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Problem</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">Exception</span></span>&#123;&#125;<span class="comment">//不允许</span></span><br><span class="line"><span class="comment">//报错：Generic class may not extend &#x27;java.lang.Throwable&#x27;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>不能捕获泛型类对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T extends Throwable&gt; <span class="function"><span class="keyword">void</span> <span class="title">doWork</span><span class="params">(T t)</span> <span class="keyword">throws</span> T </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// do...</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (T e) &#123; <span class="comment">//报错</span></span><br><span class="line">        <span class="comment">//do something</span></span><br><span class="line">        <span class="keyword">throw</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>不能捕获，但是可以抛出</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> &lt;T extends Throwable&gt; <span class="function"><span class="keyword">void</span> <span class="title">doWork2</span><span class="params">(T x)</span> <span class="keyword">throws</span> T </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//do...</span></span><br><span class="line">    &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">        <span class="keyword">throw</span> x; <span class="comment">//允许的</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2><span id="5-泛型类型能继承吗">5、泛型类型能继承吗？</span></h2><ol>
<li><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//类 Worker extents Employee类</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Worker</span> <span class="keyword">extends</span> <span class="title">Employee</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//泛型类Pair</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Pair</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li><p>Pair<worker>和Pair<employee> 没有任何继承关系</employee></worker></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Pair&lt;Employee&gt; employeePair= <span class="keyword">new</span> Pair&lt;Worker&gt;();<span class="comment">//不允许，错误的</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<ol start="2">
<li><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Pair</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> T data;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(T data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span>  <span class="class"><span class="keyword">class</span> <span class="title">ExtendPair</span>&lt;<span class="title">T</span>&gt; <span class="keyword">extends</span> <span class="title">Pair</span>&lt;<span class="title">T</span>&gt;</span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ul>
<li><p>泛型类可以继承或者扩展其他泛型类 //比如List和ArrayList</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Pair&lt;Employee&gt; employee = <span class="keyword">new</span> ExtendPair&lt;&gt;; <span class="comment">//允许的</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h2><span id="6-泛型中通配符类型只能用在方法上">6、泛型中通配符类型（?只能用在方法上）</span></h2><p>通配符主要用于安全的访问数据</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Food</span> </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Fruit</span> <span class="keyword">extends</span> <span class="title">Food</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Apple</span> <span class="keyword">extends</span> <span class="title">Fruit</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Orange</span> <span class="keyword">extends</span> <span class="title">Fruit</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HongFuShi</span> <span class="keyword">extends</span> <span class="title">Apple</span></span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol>
<li><? extends Fruit>表示Pair传进去的类型参数是Fruit的子类包括Fruit本身（Fruit,Apple,Orange,HongFuShi）
</li>
</ol>
<ul>
<li><p>extends决定了类型参数的上界：向下的范围，即泛型对象必需继承Fruit或Fruit本身–Food不可以。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//限定类型Fruit</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printClassName</span><span class="params">(Pair&lt;? extends Fruit&gt; data)</span> </span>&#123;</span><br><span class="line">    System.out.println(data.getClass().getSimpleName());</span><br><span class="line">&#125;</span><br><span class="line">Pair&lt;Fruit&gt; fruitPair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair&lt;Apple&gt; applePair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair&lt;Food&gt; foodPair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair.printClassName(fruitPair);<span class="comment">//允许</span></span><br><span class="line">Pair.printClassName(applePair);<span class="comment">//允许</span></span><br><span class="line">Pair.printClassName(foodPair);<span class="comment">//不允许</span></span><br><span class="line"><span class="comment">//错误: 不兼容的类型: Pair&lt;Food&gt;无法转换为Pair&lt;? extends Fruit&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//限定类型变量赋值时，也是只能使用传入Fruit子类或者本身的对象</span></span><br><span class="line">Pair&lt;Fruit&gt; fruitPair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair&lt;Apple&gt; applePair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair&lt;Food&gt; foodPair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair&lt;? extends Fruit&gt; f = fruitPair;<span class="comment">//允许</span></span><br><span class="line">Pair&lt;? extends Fruit&gt; f2 = applePair;<span class="comment">//允许</span></span><br><span class="line">Pair&lt;? extends Fruit&gt; f3 = foodPair;<span class="comment">//不允许</span></span><br></pre></td></tr></table></figure>



</li>
</ul>
<p>  使用&lt;? extends Fruit&gt;给对象set，get值时：set是不允许的，get只能get到Fruit对象，即extends的上界类型。</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Pair&lt;Fruit&gt; fruitPair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair&lt;Apple&gt; applePair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair&lt;? extends Fruit&gt; data = fruitPair;</span><br><span class="line">或</span><br><span class="line">Pair&lt;? extends Fruit&gt; data = applePair;</span><br><span class="line"></span><br><span class="line">data.setData(<span class="keyword">new</span> Apple());<span class="comment">//不允许</span></span><br><span class="line">data.setData(<span class="keyword">new</span> Fruit());<span class="comment">//不允许</span></span><br><span class="line"><span class="comment">//错误: 不兼容的类型: Fruit无法转换为CAP#1</span></span><br><span class="line"><span class="comment">//        data.setData(new Fruit());</span></span><br><span class="line"><span class="comment">//                     ^</span></span><br><span class="line"><span class="comment">//  其中, CAP#1是新类型变量:</span></span><br><span class="line"><span class="comment">//    CAP#1从? extends Fruit的捕获扩展Fruit</span></span><br><span class="line">Fruit fruit = data.getData();<span class="comment">//允许，获取到Fruit对象</span></span><br><span class="line">Apple apple = (Apple) data.getData();<span class="comment">//需要转型，如果类型不正确会报ClassCastException强转异常</span></span><br></pre></td></tr></table></figure>

<p>  get方法：不管我们传的是Fruit还是它的子类，对于编译器来说我们传的一定是个Fruit，所以获取到的对象一定是个Fruit（子类继承Fruit）。</p>
<p>  set方法：对于编译器来说你传的是个Fruit,但是是具体的哪一个子类，编译器是不知道的。</p>
<p><strong>&lt;? extends Fruit&gt;主要用于安全的访问数据–读数据</strong></p>
<ol start="2">
<li><? super Apple>表示Pair传进去的类型参数是Apple的父类包括Apple本身。(Apple,Fruit,Food)
</li>
</ol>
<ul>
<li><p>super 决定了类型参数的下界：向上的范围，即泛型对象是Apple的超类或Apple本身–HongFuShi不可以。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">printSuper</span><span class="params">(Pair&lt;? <span class="keyword">super</span> Apple&gt; data)</span></span>&#123;</span><br><span class="line">    System.out.println(data.getClass().getSimpleName());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Pair&lt;Fruit&gt; fruitPair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair&lt;Apple&gt; applePair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair&lt;Orange&gt; orangePair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">Pair&lt;HongFuShi&gt; hongFuShiPair = <span class="keyword">new</span> Pair&lt;&gt;();</span><br><span class="line">printSuper(fruitPair);<span class="comment">//允许</span></span><br><span class="line">printSuper(applePair);<span class="comment">//允许</span></span><br><span class="line">printSuper(orangePair);<span class="comment">//不允许，平级类</span></span><br><span class="line">printSuper(hongFuShiPair);<span class="comment">//不允许</span></span><br><span class="line"><span class="comment">//错误: 不兼容的类型: Pair&lt;HongFuShi&gt;无法转换为Pair&lt;? super Apple&gt;</span></span><br><span class="line"><span class="comment">//        printSuper(hongFuShiPair);</span></span><br><span class="line"></span><br><span class="line">Pair&lt;? <span class="keyword">super</span> Apple&gt; data = fruitPair; <span class="comment">//允许</span></span><br><span class="line">Pair&lt;? <span class="keyword">super</span> Apple&gt; data = applePair; <span class="comment">//允许</span></span><br><span class="line">Pair&lt;? <span class="keyword">super</span> Apple&gt; data = hongFuShiPair; <span class="comment">//不允许</span></span><br><span class="line"><span class="comment">//错误: 不兼容的类型: Pair&lt;HongFuShi&gt;无法转换为Pair&lt;? super Apple&gt;</span></span><br><span class="line"><span class="comment">//        Pair&lt;? super Apple&gt; data = hongFuShiPair;</span></span><br><span class="line"><span class="comment">//                                   ^</span></span><br><span class="line"></span><br><span class="line">但是在设值的时候只能设置Apple的子类和它本身</span><br><span class="line">data.setData(<span class="keyword">new</span> Apple()); <span class="comment">//允许</span></span><br><span class="line">data.setData(<span class="keyword">new</span> HongFuShi()); <span class="comment">//允许</span></span><br><span class="line">data.setData(<span class="keyword">new</span> Fruit()); <span class="comment">//不允许</span></span><br><span class="line"><span class="comment">//错误: 不兼容的类型: Fruit无法转换为CAP#1</span></span><br><span class="line"><span class="comment">//        data.setData(new Fruit());</span></span><br><span class="line"><span class="comment">//                    ^</span></span><br><span class="line"><span class="comment">// 其中, CAP#1是新类型变量:</span></span><br><span class="line"><span class="comment">//    CAP#1从? super Apple的捕获扩展Object 超 Apple</span></span><br><span class="line"></span><br><span class="line">获取数据时获取到的是Object对象</span><br><span class="line">Object object = data.getData();</span><br></pre></td></tr></table></figure>

<? super Apple>

set方法：只能传Apple和其子类，（因为子类包含了Apple或者HongFuShi，子类可以安全的转换为 super Apple）

get方法：获取的对象一定是Apple的超类，Java中Object一定是Apple的超类。所以返回的是Object

</li>
</ul>
<p><strong>&lt;? super Apple&gt;主要用于安全的写入数据，只能是其本身Apple和其子类</strong></p>
<h2><span id="7-虚拟机是如何实现泛型的">7、虚拟机是如何实现泛型的？</span></h2><p>我们定义了一个简单的泛型类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorASM</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> E data;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(E data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过字节码查看工具查看该类的字节码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// class version 52.0 (52)</span></span><br><span class="line"><span class="comment">// access flags 0x21</span></span><br><span class="line"><span class="comment">// signature &lt;E:Ljava/lang/Object;&gt;Ljava/lang/Object;</span></span><br><span class="line"><span class="comment">// declaration: GenertorASM&lt;E&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorASM</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// compiled from: GenertorASM.java</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x2</span></span><br><span class="line">  <span class="comment">// signature TE;</span></span><br><span class="line">  <span class="comment">// declaration: data extends E</span></span><br><span class="line">  <span class="keyword">private</span> Ljava/lang/Object; data</span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x1</span></span><br><span class="line">  <span class="keyword">public</span> &lt;init&gt;()V</span><br><span class="line">   L0</span><br><span class="line">    LINENUMBER <span class="number">8</span> L0</span><br><span class="line">    ALOAD <span class="number">0</span></span><br><span class="line">    INVOKESPECIAL java/lang/Object.&lt;init&gt; ()V</span><br><span class="line">    RETURN</span><br><span class="line">   L1</span><br><span class="line">    LOCALVARIABLE <span class="keyword">this</span> LGenertorASM; L0 L1 <span class="number">0</span></span><br><span class="line">    <span class="comment">// signature LGenertorASM&lt;TE;&gt;;</span></span><br><span class="line">    <span class="comment">// declaration: this extends GenertorASM&lt;E&gt;</span></span><br><span class="line">    MAXSTACK = <span class="number">1</span></span><br><span class="line">    MAXLOCALS = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x1</span></span><br><span class="line">  <span class="comment">// signature ()TE;</span></span><br><span class="line">  <span class="comment">// declaration: E getData()</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">getData</span><span class="params">()</span>Ljava/lang/Object</span>;</span><br><span class="line">   L0</span><br><span class="line">    LINENUMBER <span class="number">12</span> L0</span><br><span class="line">    ALOAD <span class="number">0</span></span><br><span class="line">    GETFIELD GenertorASM.data : Ljava/lang/Object;</span><br><span class="line">    ARETURN</span><br><span class="line">   L1</span><br><span class="line">    LOCALVARIABLE <span class="keyword">this</span> LGenertorASM; L0 L1 <span class="number">0</span></span><br><span class="line">    <span class="comment">// signature LGenertorASM&lt;TE;&gt;;</span></span><br><span class="line">    <span class="comment">// declaration: this extends GenertorASM&lt;E&gt;</span></span><br><span class="line">    MAXSTACK = <span class="number">1</span></span><br><span class="line">    MAXLOCALS = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x1</span></span><br><span class="line">  <span class="comment">// signature (TE;)V</span></span><br><span class="line">  <span class="comment">// declaration: void setData(E)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">setData</span><span class="params">(Ljava/lang/Object;)</span>V</span></span><br><span class="line"><span class="function">   L0</span></span><br><span class="line"><span class="function">    LINENUMBER 16 L0</span></span><br><span class="line"><span class="function">    ALOAD 0</span></span><br><span class="line"><span class="function">    ALOAD 1</span></span><br><span class="line"><span class="function">    PUTFIELD GenertorASM.data : Ljava/lang/Object</span>;</span><br><span class="line">   L1</span><br><span class="line">    LINENUMBER <span class="number">17</span> L1</span><br><span class="line">    RETURN</span><br><span class="line">   L2</span><br><span class="line">    LOCALVARIABLE <span class="keyword">this</span> LGenertorASM; L0 L2 <span class="number">0</span></span><br><span class="line">    <span class="comment">// signature LGenertorASM&lt;TE;&gt;;</span></span><br><span class="line">    <span class="comment">// declaration: this extends GenertorASM&lt;E&gt;</span></span><br><span class="line">    LOCALVARIABLE data Ljava/lang/Object; L0 L2 <span class="number">1</span></span><br><span class="line">    <span class="comment">// signature TE;</span></span><br><span class="line">    <span class="comment">// declaration: data extends E</span></span><br><span class="line">    MAXSTACK = <span class="number">2</span></span><br><span class="line">    MAXLOCALS = <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>或者使用javap命令反编译.class文件</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">javap -c -l GenertorASM.class	<span class="comment">// -c对代码进行反汇编,-l输出行号和本地变量表</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorASM</span>&lt;<span class="title">E</span>&gt; </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">GenertorASM</span><span class="params">()</span></span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: aload_0</span><br><span class="line">       1: invokespecial #1                  // Method java/lang/Object.&quot;&lt;init&gt;&quot;:()V</span><br><span class="line">       <span class="number">4</span>: <span class="keyword">return</span></span><br><span class="line">    LineNumberTable:</span><br><span class="line">      line <span class="number">8</span>: <span class="number">0</span></span><br><span class="line">    LocalVariableTable:</span><br><span class="line">      Start  Length  Slot  Name   Signature</span><br><span class="line">          <span class="number">0</span>       <span class="number">5</span>     <span class="number">0</span>  <span class="keyword">this</span>   LGenertorASM;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> E <span class="title">getData</span><span class="params">()</span></span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: aload_0</span><br><span class="line">       1: getfield      #2                  // Field data:Ljava/lang/Object;</span><br><span class="line">       <span class="number">4</span>: areturn</span><br><span class="line">    LineNumberTable:</span><br><span class="line">      line <span class="number">12</span>: <span class="number">0</span></span><br><span class="line">    LocalVariableTable:</span><br><span class="line">      Start  Length  Slot  Name   Signature</span><br><span class="line">          <span class="number">0</span>       <span class="number">5</span>     <span class="number">0</span>  <span class="keyword">this</span>   LGenertorASM;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(E)</span></span>;</span><br><span class="line">    Code:</span><br><span class="line">       <span class="number">0</span>: aload_0</span><br><span class="line">       <span class="number">1</span>: aload_1</span><br><span class="line">       2: putfield      #2                  // Field data:Ljava/lang/Object;</span><br><span class="line">       <span class="number">5</span>: <span class="keyword">return</span></span><br><span class="line">    LineNumberTable:</span><br><span class="line">      line <span class="number">16</span>: <span class="number">0</span></span><br><span class="line">      line <span class="number">17</span>: <span class="number">5</span></span><br><span class="line">    LocalVariableTable:</span><br><span class="line">      Start  Length  Slot  Name   Signature</span><br><span class="line">          <span class="number">0</span>       <span class="number">6</span>     <span class="number">0</span>  <span class="keyword">this</span>   LGenertorASM;</span><br><span class="line">          <span class="number">0</span>       <span class="number">6</span>     <span class="number">1</span>  data   Ljava/lang/Object;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过反编译后，可以看到泛型被擦除了，对应的是Object对象，但在的signature中记录了泛型。</p>
<p>泛型擦除的原因：</p>
<pre><code>在Java1.5之前不存在泛型的，1.5之后才添加的泛型，为了向下兼容，所以在编译时使用了泛型擦除用Object代替。</code></pre>
<p>使用泛型限定符时,java编译时会将泛型转成限定符的类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorASM</span>&lt;<span class="title">E</span> <span class="keyword">extends</span> <span class="title">Fruit</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> E data;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(E data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>字节码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// class version 52.0 (52)</span></span><br><span class="line"><span class="comment">// access flags 0x21</span></span><br><span class="line"><span class="comment">// signature &lt;E:LFruit;&gt;Ljava/lang/Object;</span></span><br><span class="line"><span class="comment">// declaration: GenertorASM&lt;E extends Fruit&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorASM</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// compiled from: GenertorASM.java</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x2</span></span><br><span class="line">  <span class="comment">// signature TE;</span></span><br><span class="line">  <span class="comment">// declaration: data extends E</span></span><br><span class="line">  <span class="keyword">private</span> LFruit; data</span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x1</span></span><br><span class="line">  <span class="keyword">public</span> &lt;init&gt;()V</span><br><span class="line">   L0</span><br><span class="line">    LINENUMBER <span class="number">8</span> L0</span><br><span class="line">    ALOAD <span class="number">0</span></span><br><span class="line">    INVOKESPECIAL java/lang/Object.&lt;init&gt; ()V</span><br><span class="line">    RETURN</span><br><span class="line">   L1</span><br><span class="line">    LOCALVARIABLE <span class="keyword">this</span> LGenertorASM; L0 L1 <span class="number">0</span></span><br><span class="line">    <span class="comment">// signature LGenertorASM&lt;TE;&gt;;</span></span><br><span class="line">    <span class="comment">// declaration: this extends GenertorASM&lt;E&gt;</span></span><br><span class="line">    MAXSTACK = <span class="number">1</span></span><br><span class="line">    MAXLOCALS = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x1</span></span><br><span class="line">  <span class="comment">// signature ()TE;</span></span><br><span class="line">  <span class="comment">// declaration: E getData()</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">getData</span><span class="params">()</span>LFruit</span>;</span><br><span class="line">   L0</span><br><span class="line">    LINENUMBER <span class="number">11</span> L0</span><br><span class="line">    ALOAD <span class="number">0</span></span><br><span class="line">    GETFIELD GenertorASM.data : LFruit;</span><br><span class="line">    ARETURN</span><br><span class="line">   L1</span><br><span class="line">    LOCALVARIABLE <span class="keyword">this</span> LGenertorASM; L0 L1 <span class="number">0</span></span><br><span class="line">    <span class="comment">// signature LGenertorASM&lt;TE;&gt;;</span></span><br><span class="line">    <span class="comment">// declaration: this extends GenertorASM&lt;E&gt;</span></span><br><span class="line">    MAXSTACK = <span class="number">1</span></span><br><span class="line">    MAXLOCALS = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x1</span></span><br><span class="line">  <span class="comment">// signature (TE;)V</span></span><br><span class="line">  <span class="comment">// declaration: void setData(E)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">setData</span><span class="params">(LFruit;)</span>V</span></span><br><span class="line"><span class="function">   L0</span></span><br><span class="line"><span class="function">    LINENUMBER 14 L0</span></span><br><span class="line"><span class="function">    ALOAD 0</span></span><br><span class="line"><span class="function">    ALOAD 1</span></span><br><span class="line"><span class="function">    PUTFIELD GenertorASM.data : LFruit</span>;</span><br><span class="line">   L1</span><br><span class="line">    LINENUMBER <span class="number">15</span> L1</span><br><span class="line">    RETURN</span><br><span class="line">   L2</span><br><span class="line">    LOCALVARIABLE <span class="keyword">this</span> LGenertorASM; L0 L2 <span class="number">0</span></span><br><span class="line">    <span class="comment">// signature LGenertorASM&lt;TE;&gt;;</span></span><br><span class="line">    <span class="comment">// declaration: this extends GenertorASM&lt;E&gt;</span></span><br><span class="line">    LOCALVARIABLE data LFruit; L0 L2 <span class="number">1</span></span><br><span class="line">    <span class="comment">// signature TE;</span></span><br><span class="line">    <span class="comment">// declaration: data extends E</span></span><br><span class="line">    MAXSTACK = <span class="number">2</span></span><br><span class="line">    MAXLOCALS = <span class="number">2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果限定符有多个时，字节码中泛型使用第一个限定的类型，在使用其他的类型时，会使用强转成对应的类型（所以多个限定符时要注意强转异常）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorASM</span>&lt;<span class="title">E</span> <span class="keyword">extends</span> <span class="title">Fruit</span> &amp; <span class="title">Comparable</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> E data;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">getData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setData</span><span class="params">(E data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> E <span class="title">compare</span><span class="params">(E data1, E data2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> data1.compareTo(data2) &gt; <span class="number">0</span> ? data1 : data2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>字节码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// class version 52.0 (52)</span></span><br><span class="line"><span class="comment">// access flags 0x21</span></span><br><span class="line"><span class="comment">// signature &lt;E:LFruit;:Ljava/lang/Comparable;&gt;Ljava/lang/Object;</span></span><br><span class="line"><span class="comment">// declaration: GenertorASM&lt;E extends Fruit extends java.lang.Comparable&gt;</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GenertorASM</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// compiled from: GenertorASM.java</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x2</span></span><br><span class="line">  <span class="comment">// signature TE;</span></span><br><span class="line">  <span class="comment">// declaration: data extends E</span></span><br><span class="line">  <span class="keyword">private</span> LFruit; data</span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x1</span></span><br><span class="line">  <span class="keyword">public</span> &lt;init&gt;()V</span><br><span class="line">   L0</span><br><span class="line">    LINENUMBER <span class="number">8</span> L0</span><br><span class="line">    ALOAD <span class="number">0</span></span><br><span class="line">    INVOKESPECIAL java/lang/Object.&lt;init&gt; ()V</span><br><span class="line">    RETURN</span><br><span class="line">   L1</span><br><span class="line">    LOCALVARIABLE <span class="keyword">this</span> LGenertorASM; L0 L1 <span class="number">0</span></span><br><span class="line">    <span class="comment">// signature LGenertorASM&lt;TE;&gt;;</span></span><br><span class="line">    <span class="comment">// declaration: this extends GenertorASM&lt;E&gt;</span></span><br><span class="line">    MAXSTACK = <span class="number">1</span></span><br><span class="line">    MAXLOCALS = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x1</span></span><br><span class="line">  <span class="comment">// signature ()TE;</span></span><br><span class="line">  <span class="comment">// declaration: E getData()</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">getData</span><span class="params">()</span>LFruit</span>;</span><br><span class="line">   L0</span><br><span class="line">    LINENUMBER <span class="number">12</span> L0</span><br><span class="line">    ALOAD <span class="number">0</span></span><br><span class="line">    GETFIELD GenertorASM.data : LFruit;</span><br><span class="line">    ARETURN</span><br><span class="line">   L1</span><br><span class="line">    LOCALVARIABLE <span class="keyword">this</span> LGenertorASM; L0 L1 <span class="number">0</span></span><br><span class="line">    <span class="comment">// signature LGenertorASM&lt;TE;&gt;;</span></span><br><span class="line">    <span class="comment">// declaration: this extends GenertorASM&lt;E&gt;</span></span><br><span class="line">    MAXSTACK = <span class="number">1</span></span><br><span class="line">    MAXLOCALS = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x1</span></span><br><span class="line">  <span class="comment">// signature (TE;)V</span></span><br><span class="line">  <span class="comment">// declaration: void setData(E)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">setData</span><span class="params">(LFruit;)</span>V</span></span><br><span class="line"><span class="function">   L0</span></span><br><span class="line"><span class="function">    LINENUMBER 16 L0</span></span><br><span class="line"><span class="function">    ALOAD 0</span></span><br><span class="line"><span class="function">    ALOAD 1</span></span><br><span class="line"><span class="function">    PUTFIELD GenertorASM.data : LFruit</span>;</span><br><span class="line">   L1</span><br><span class="line">    LINENUMBER <span class="number">17</span> L1</span><br><span class="line">    RETURN</span><br><span class="line">   L2</span><br><span class="line">    LOCALVARIABLE <span class="keyword">this</span> LGenertorASM; L0 L2 <span class="number">0</span></span><br><span class="line">    <span class="comment">// signature LGenertorASM&lt;TE;&gt;;</span></span><br><span class="line">    <span class="comment">// declaration: this extends GenertorASM&lt;E&gt;</span></span><br><span class="line">    LOCALVARIABLE data LFruit; L0 L2 <span class="number">1</span></span><br><span class="line">    <span class="comment">// signature TE;</span></span><br><span class="line">    <span class="comment">// declaration: data extends E</span></span><br><span class="line">    MAXSTACK = <span class="number">2</span></span><br><span class="line">    MAXLOCALS = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// access flags 0x1</span></span><br><span class="line">  <span class="comment">// signature (TE;TE;)TE;</span></span><br><span class="line">  <span class="comment">// declaration: E compare(E, E)</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">compare</span><span class="params">(LFruit;LFruit;)</span>LFruit</span>;</span><br><span class="line">   L0</span><br><span class="line">    LINENUMBER <span class="number">20</span> L0</span><br><span class="line">    ALOAD <span class="number">1</span></span><br><span class="line">    CHECKCAST java/lang/Comparable</span><br><span class="line">    ALOAD <span class="number">2</span></span><br><span class="line">    INVOKEINTERFACE java/lang/Comparable.compareTo (Ljava/lang/Object;)I (itf)</span><br><span class="line">    IFLE L1</span><br><span class="line">    ALOAD <span class="number">1</span></span><br><span class="line">    GOTO L2</span><br><span class="line">   L1</span><br><span class="line">   FRAME SAME</span><br><span class="line">    ALOAD <span class="number">2</span></span><br><span class="line">   L2</span><br><span class="line">   FRAME SAME1 Fruit</span><br><span class="line">    ARETURN</span><br><span class="line">   L3</span><br><span class="line">    LOCALVARIABLE <span class="keyword">this</span> LGenertorASM; L0 L3 <span class="number">0</span></span><br><span class="line">    <span class="comment">// signature LGenertorASM&lt;TE;&gt;;</span></span><br><span class="line">    <span class="comment">// declaration: this extends GenertorASM&lt;E&gt;</span></span><br><span class="line">    LOCALVARIABLE data1 LFruit; L0 L3 <span class="number">1</span></span><br><span class="line">    <span class="comment">// signature TE;</span></span><br><span class="line">    <span class="comment">// declaration: data1 extends E</span></span><br><span class="line">    LOCALVARIABLE data2 LFruit; L0 L3 <span class="number">2</span></span><br><span class="line">    <span class="comment">// signature TE;</span></span><br><span class="line">    <span class="comment">// declaration: data2 extends E</span></span><br><span class="line">    MAXSTACK = <span class="number">2</span></span><br><span class="line">    MAXLOCALS = <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>在字节码中<code>CHECKCAST java/lang/Comparable</code> 将对象强转成Comparable类型</p>
<p>相同方法使用泛型，类型不同时报错-因为在编译时类型擦除后的对象都是Objects</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">method</span> <span class="params">(List&lt;String&gt; list)</span></span>&#123;</span><br><span class="line">       </span><br><span class="line">   &#125;</span><br><span class="line"><span class="comment">//报错：&#x27;method(List&lt;String&gt;)&#x27; clashes with &#x27;method(List&lt;Integer&gt;)&#x27;; both methods have same erasure</span></span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">method</span> <span class="params">(List&lt;Integer&gt; list)</span></span>&#123;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>另外在jdk中如果返回值不同（一个返回String，一个返回Integer），编译是不会报错的，但是开发工具中是报上面错的（idea这种只比较方法名和参数没有比较返回值）</p>
<h2><span id="8-反射获取泛型的真实类型">8、反射获取泛型的真实类型</span></h2><p>当我们对一个泛型类进行反射时，需要得到泛型中的真实数据类型，业完成如json反序列化的操作。此时需要通过Type体系来完成。Type接口包含了一个实现类(Class)和四个实现接口，他们分别是：</p>
<ul>
<li>TypeVariable<ul>
<li>泛型类型变量。可以获得泛型上下限等信息。</li>
</ul>
</li>
<li>ParameterizedType<ul>
<li>具体的泛型类型，可以获得元数据中泛型签名类型（泛型真实类型）。</li>
</ul>
</li>
<li>GenericArrayType<ul>
<li>当需要描述的类型是泛型类的数组时，比如List[],Map[]，此接口会作为Type的实现。</li>
</ul>
</li>
<li>WildcardType<ul>
<li>通配符泛型，获得上下限信息。</li>
</ul>
</li>
</ul>
<p>Type是个接口,它的直接实现类就是Class</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> java.lang.reflect;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@since</span> 1.5</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Type</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">default</span> String <span class="title">getTypeName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Class</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">Type</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> 我们创建一个Response泛型类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Response</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    T data;</span><br><span class="line">    <span class="keyword">int</span> code;</span><br><span class="line">    String message;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Response</span><span class="params">(T data, <span class="keyword">int</span> code, String message)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">        <span class="keyword">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Data</span> </span>&#123;</span><br><span class="line">        String result;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Data</span><span class="params">(String result)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.result = result;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Response&lt;Data&gt; response = <span class="keyword">new</span> Response&lt;&gt;(<span class="keyword">new</span> Data(<span class="string">&quot;数据&quot;</span>), <span class="number">0</span>, <span class="string">&quot;成功&quot;</span>);</span><br><span class="line">        Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">        String json = gson.toJson(response);</span><br><span class="line">        System.out.println(json);</span><br><span class="line"></span><br><span class="line">        Response&lt;Data&gt; result = gson.fromJson(json,Response.class);</span><br><span class="line">        System.out.println(result.data.getClass());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们创建一个response对象传入Data数据类型，打印序列化后的数据</p>
<p><code>&#123;&quot;data&quot;:&#123;&quot;result&quot;:&quot;数据&quot;&#125;,&quot;code&quot;:0,&quot;message&quot;:&quot;成功&quot;&#125;</code></p>
<p>然后我们通过gson反序列化打印data类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Exception in thread &quot;main&quot; java.lang.ClassCastException: com.google.gson.internal.LinkedTreeMap cannot be cast to com.lis.wanjob.jol.Response$Data</span></span><br><span class="line"><span class="comment">//	at com.lis.wanjob.jol.Response.main(Response.java:35)</span></span><br></pre></td></tr></table></figure>

<p>gson解析时会把Data认为是LinkedTreeMap类型，所以在打印时强制转换时报错了。</p>
<p>正确的解析是通过Type</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Type type = <span class="keyword">new</span> TypeToken&lt;Response&lt;Data&gt;&gt;() &#123;</span><br><span class="line">        &#125;.getType();</span><br><span class="line">System.out.println(type);</span><br><span class="line">Response&lt;Data&gt; result = gson.fromJson(json, type);</span><br><span class="line">System.out.println(result.data.getClass());</span><br><span class="line">--打印结果为：</span><br><span class="line">com.lis.wanjob.jol.Response&lt;com.lis.wanjob.jol.Response$Data&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">lis</span>.<span class="title">wanjob</span>.<span class="title">jol</span>.<span class="title">Response</span>$<span class="title">Data</span></span></span><br></pre></td></tr></table></figure>

<p>我们看一下TypeToken的源码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">   <span class="function"><span class="keyword">protected</span> <span class="title">TypeToken</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">this</span>.type = getSuperclassTypeParameter(<span class="keyword">this</span>.getClass());</span><br><span class="line">       <span class="keyword">this</span>.rawType = Types.getRawType(<span class="keyword">this</span>.type);</span><br><span class="line">       <span class="keyword">this</span>.hashCode = <span class="keyword">this</span>.type.hashCode();</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">static</span> Type <span class="title">getSuperclassTypeParameter</span><span class="params">(Class&lt;?&gt; subclass)</span> </span>&#123;</span><br><span class="line">       Type superclass = subclass.getGenericSuperclass();</span><br><span class="line">       <span class="keyword">if</span> (superclass <span class="keyword">instanceof</span> Class) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;Missing type parameter.&quot;</span>);</span><br><span class="line">       &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">           ParameterizedType parameterized = (ParameterizedType)superclass;</span><br><span class="line">           <span class="keyword">return</span> Types.canonicalize(parameterized.getActualTypeArguments()[<span class="number">0</span>]);</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Type <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="keyword">this</span>.type;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>这里我们调用的是TypeToken 受保护的构造函数，getType()就是返回的type.</p>
<p>getSuperclassTypeParameter()方法中，如果TypeToken类的类型type是泛型类型的话，会被装载为Type的子接口ParameterizedType，可以让我们得到具体的泛型类型。</p>
<p>在实例化TypeToken时使用{}，实际上是匿名内部类。</p>
<p>我们自己创建个类来解析泛型的真实类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeReference</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">        Type actualTyep;</span><br><span class="line"></span><br><span class="line">        <span class="function">Type <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> actualTyep;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">TypeReference</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            Type superclass = getClass().getGenericSuperclass();</span><br><span class="line">            ParameterizedType type = (ParameterizedType) superclass;</span><br><span class="line">            <span class="comment">//这里是数组，因为泛型可以有多个&lt;T,E&gt;</span></span><br><span class="line">            Type[] actualTypeArguments = type.getActualTypeArguments();</span><br><span class="line">            actualTyep = actualTypeArguments[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>不加{}<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//不加&#123;&#125;时，new TypeReference&lt;Response&lt;Data&gt;&gt;()代表一个对象</span></span><br><span class="line">Type type2 = <span class="keyword">new</span> TypeReference&lt;Response&lt;Data&gt;&gt;().getType();</span><br><span class="line">System.out.println(type2);</span><br><span class="line">Response&lt;Data&gt; result = gson.fromJson(json, type2);</span><br><span class="line">System.out.println(result.data.getClass());</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>我们在输出时，不加{}时报错</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Exception in thread <span class="string">&quot;main&quot;</span> java.lang.ClassCastException: java.lang.Class cannot be cast to java.lang.reflect.ParameterizedType</span><br><span class="line">	at com.lis.wanjob.jol.Response$TypeReference.&lt;init&gt;(Response.java:<span class="number">41</span>)</span><br><span class="line">	at com.lis.wanjob.jol.Response.main(Response.java:<span class="number">62</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>加{}<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加&#123;&#125;时，new TypeReference&lt;Response&lt;Data&gt;&gt;()&#123;&#125;代表一个匿名内部类</span></span><br><span class="line">Type type2 = <span class="keyword">new</span> TypeReference&lt;Response&lt;Data&gt;&gt;()&#123;&#125;.getType();</span><br><span class="line">System.out.println(type2);</span><br><span class="line">Response&lt;Data&gt; result = gson.fromJson(json, type2);</span><br><span class="line">System.out.println(result.data.getClass());</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>我们输出时：能正常的打印泛型的真实类型</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">com.lis.wanjob.jol.Response&lt;com.lis.wanjob.jol.Response$Data&gt;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">com</span>.<span class="title">lis</span>.<span class="title">wanjob</span>.<span class="title">jol</span>.<span class="title">Response</span>$<span class="title">Data</span></span></span><br></pre></td></tr></table></figure>

<ol>
<li><p>因为不加{}时，new TypeReference&lt;Response<data>&gt;()只是一个对象，在TypeReference没有记录泛型真实类型的地方，此时的Type就是Class,所以强转ParameterizedType时会报错。编译文件Response$TypeReference.class，as中查看：</data></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Response</span>$<span class="title">TypeReference</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    Type actualTyep;</span><br><span class="line"></span><br><span class="line">    <span class="function">Type <span class="title">getType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.actualTyep;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Response$TypeReference() &#123;</span><br><span class="line">        Type superclass = <span class="keyword">this</span>.getClass().getGenericSuperclass();</span><br><span class="line">        ParameterizedType type = (ParameterizedType)superclass;</span><br><span class="line">        Type[] actualTypeArguments = type.getActualTypeArguments();</span><br><span class="line">        <span class="keyword">this</span>.actualTyep = actualTypeArguments[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><p>加了{}时，new TypeReference&lt;Response<data>&gt;(){}是匿名内部类，编译时，会为我们生成对应的内部类的文件Response$1.class，我们在as中打开看到如下代码</data></p>
</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Response</span>$1 <span class="keyword">extends</span> <span class="title">TypeReference</span>&lt;<span class="title">Response</span>&lt;<span class="title">Data</span>&gt;&gt; </span>&#123;</span><br><span class="line">    Response$<span class="number">1</span>() &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>内部类中记录了泛型的真实类型。在getType()获取类型时，其实是获取的内部类的类型，所以我们可以得到泛型的真实类型。</p>
<p>PS：我们可以将解析泛型的真实类型的类定义为抽象或将构造方法改为受保护的（必需不同包下），这样在创建解析类时必需加{}成为匿名内部类，来获取泛型的真实类型。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeReference</span>&lt;<span class="title">T</span>&gt;</span>&#123;&#125;</span><br><span class="line">或</span><br><span class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">TypeReference</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="title">TypeReference</span><span class="params">()</span> </span>&#123;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="article-licensing box"><div class="licensing-title"><p>泛型</p><p><a href="http://example.com/2021/11/28/泛型/">http://example.com/2021/11/28/泛型/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><a href="http://example.com"><p>Lis</p></a></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-11-28</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2025-05-15</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://xunyixiangchao.github.io/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://xunyixiangchao.github.io/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://xunyixiangchao.github.io/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="recommend-area"><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 相关文章</span><br><span>  1.<a class="is-size-6" href="/2025/05/15/%E6%B3%A8%E8%A7%A3%E4%B8%8E%E5%8F%8D%E5%B0%84/" target="_blank">注解与反射（上）</a><br></span></div><div class="recommend-post"><span class="is-size-6 has-text-grey has-mr-7"># 推荐文章</span><br><span>  1.<a class="is-size-6" href="/2021/06/15/view/" target="_blank">View基础</a><br></span></div></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/css/share.min.css"><div class="social-share"></div><script src="https://cdnjs.loli.net/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">喜欢这篇文章？打赏一下作者吧</h3><div class="buttons is-centered"><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>支付宝</span><span class="qrcode"><img src="/" alt="支付宝"></span></a><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>微信</span><span class="qrcode"><img src="/" alt="微信"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2025/04/07/chapter-03/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">第三章 认识系统组件</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/06/15/view/"><span class="level-item">View基础</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--><div class="card"><div class="card-content"><div class="title is-5">评论</div><div id="comment-container"></div><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/gitalk/1.6.0/gitalk.css"><script> $.getScript('/js/gitalk.min.js', function () { 
            var gitalk = new Gitalk({
            language:'zh-CN',
            id: '87c43109c986a268524d96c0594afbdf',
            repo: 'gitalk',
            owner: 'xunyixiangchao',
            clientID: '9e8b7b8cef8759344d50',
            clientSecret: 'e5ef7e0a75d0431208a8fc15f1b41bd45bf0ca2d',
            admin: ["xunyixiangchao"],
            createIssueManually: true,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: 'last',
            proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token',
            
            enableHotKey: true,
            isLocked: false
        })
        gitalk.render('comment-container')});</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><!--!--><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/2018.jpg" alt="Lis"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Lis</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">10</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">3</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">9</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/xunyixiangchao" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/xunyixiangchao"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Weibo" href="https://weibo.com/xunyixiangchao"><i class="fab fa-weibo"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="mailto:Lis@163.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Next" href="https://xunyixiangchao.github.io/"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div><div><hr><p id="hitokoto">:D 一言句子获取中...</p><script type="text/javascript" defer>function getYiyan(){
                                $.getJSON("https://v1.hitokoto.cn/", function (data) {
                                if(data){
                                    $('#hitokoto').html("");
                                    $('#hitokoto').append("<strong style='color: #3273dc;'>"+data.hitokoto+"</strong>"+
                                    "<p>"+"来源《"+data.from+"》</p><p>提供者-"+data.creator+"</p>");
                                }});}
                                $(function (){getYiyan();$('#hitokoto').click(function(){getYiyan();})});</script></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新评论</h3><span class="body_hot_comment">加载中，最新评论有1分钟缓存...</span></div></div><div class="card widget"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-05-15T08:51:54.000Z">2025-05-15</time></p><p class="title"><a href="/2025/05/15/%E6%B3%A8%E8%A7%A3%E4%B8%8E%E5%8F%8D%E5%B0%84/">注解与反射（上）</a></p><p class="categories"><a href="/categories/Java%E5%9F%BA%E7%A1%80%E4%B8%8E%E8%BF%9B%E9%98%B6/">Java基础与进阶</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-04-07T03:45:54.000Z">2025-04-07</time></p><p class="title"><a href="/2025/04/07/chapter-07/">第七章 类加载和函数调用</a></p><p class="categories"><a href="/categories/Android%E6%BA%90%E7%A0%81/">Android源码</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2025-04-07T03:45:54.000Z">2025-04-07</time></p><p class="title"><a href="/2025/04/07/chapter-03/">第三章 认识系统组件</a></p><p class="categories"><a href="/categories/Android%E6%BA%90%E7%A0%81/">Android源码</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-11-28T14:45:54.000Z">2021-11-28</time></p><p class="title"><a href="/2021/11/28/%E6%B3%9B%E5%9E%8B/">泛型</a></p><p class="categories"><a href="/categories/Java%E5%9F%BA%E7%A1%80%E4%B8%8E%E8%BF%9B%E9%98%B6/">Java基础与进阶</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/06/15/view/"><img src="https://cdn.jsdelivr.net/gh/removeif/blog_image/img/2019/20190919221611.png" alt="View基础"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-06-15T06:56:23.000Z">2021-06-15</time></p><p class="title"><a href="/2021/06/15/view/">View基础</a></p></div></article></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/categories/Android%E4%B8%89%E6%96%B9%E5%BA%93%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"><span class="level-start"><span class="level-item">Android三方库源码分析</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Android%E6%BA%90%E7%A0%81/"><span class="level-start"><span class="level-item">Android源码</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/categories/Java%E5%9F%BA%E7%A1%80%E4%B8%8E%E8%BF%9B%E9%98%B6/"><span class="level-start"><span class="level-item">Java基础与进阶</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile is-marginless" href="/archives/2025/05/"><span class="level-start"><span class="level-item">五月 2025</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2025/04/"><span class="level-start"><span class="level-item">四月 2025</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile is-marginless" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><a class="level is-mobile is-marginless" href="/archives/"><span class="level-start"><span class="level-item">查看全部&gt;&gt;</span></span></a></ul></div></div></div><div class="card widget"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Android%E6%BA%90%E7%A0%81/"><span class="tag">Android源码</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java/"><span class="tag">Java</span><span class="tag is-grey-lightest">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OkHttp/"><span class="tag">OkHttp</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/activity/"><span class="tag">activity</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/dispatch/"><span class="tag">dispatch</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86/"><span class="tag">动态代理</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8D%E5%B0%84/"><span class="tag">反射</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B3%9B%E5%9E%8B/"><span class="tag">泛型</span><span class="tag is-grey-lightest">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B3%A8%E8%A7%A3/"><span class="tag">注解</span><span class="tag is-grey-lightest">1</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><!--!--><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/2018.jpg" alt="Lis" height="28"></a><p class="size-small"><span>&copy; 2025 Lis</span>  Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a> &amp; <a href="https://github.com/removeif/hexo-theme-amazing" target="_blank">Amazing</a> <br><span>© 版权说明：[本网站所有内容均收集于互联网或自己创作,<br />&nbsp;&nbsp;&nbsp;&nbsp;方便于网友与自己学习交流，如有侵权，请<a href="/message" target="_blank">留言</a>，立即处理]<br /></span><div class="size-small"><span>❤️感谢 <strong><span id="busuanzi_value_site_uv">99+</span></strong> 小伙伴的 <strong><span id="busuanzi_value_site_pv">99+</span></strong> 次光临！❤️</span></div></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://xunyixiangchao.github.io/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://xunyixiangchao.github.io/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://xunyixiangchao.github.io/"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.6.8/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.7.0/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><script>$.getScript('/js/comment-issue-data.js',function(){loadIssueData('9e8b7b8cef8759344d50','e5ef7e0a75d0431208a8fc15f1b41bd45bf0ca2d','xunyixiangchao','gitalk',false);})</script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.js"></script><script type="text/javascript">var pjax = new Pjax({
            elements: "a",//代表点击链接就更新
            selectors: [  //代表要更新的节点
                ".section",
                "title"
            ],
            cache: true,
            cacheBust:false
        })

        function loadBusuanzi(){
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js", function () {});
        }

        function loadMathJax() { //加载mathjax
            $.getScript("//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML", function () {
                MathJax.Hub.Config({ tex2jax: { inlineMath: [['$', '$'], ['\(', '\)']] } });
                var math = document.getElementsByClassName("entry-content")[0];
                MathJax.Hub.Queue(["Typeset", MathJax.Hub, math]);
            });
        };

        // 开始 PJAX 执行的函数
        document.addEventListener('pjax:send', function () {
        });
        
        // PJAX 完成之后执行的函数，可以和上面的重载放在一起
        document.addEventListener('pjax:complete', function () {
            $(".section").css({opacity:1});
            if(true){
                $.getScript('/js/comment-issue-data.js',function(){loadIssueData('9e8b7b8cef8759344d50','e5ef7e0a75d0431208a8fc15f1b41bd45bf0ca2d','xunyixiangchao','gitalk',false);});
            }
            if(false){
                loadMathJax();
            }
            loadMainJs(jQuery, window.moment, window.ClipboardJS, window.IcarusThemeSettings);
            loadBackTop();
            loadBusuanzi();
            if(typeof loadBanner == 'function'){
                loadBanner();
            }
        });</script></body></html>